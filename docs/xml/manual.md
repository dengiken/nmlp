# NML
## 1. ファイル構成
## 2. NML 基本構造
### 2.1. xml 宣言
必ず1行目に記載してください。

「UTF-8」以外の文字コードは保証されません。
```
<?xml version="1.0" encoding="UTF-8" ?>
```
### 2.2. sequence 要素
#### 概要
「シーケンス」を表すルート要素です。

1つのNMLファイルにつき一つしか許可されません。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
|title 属性|任意　タイトルを指定します。
|public 属性|任意　公開状態を指定します。（デフォルト値 true）
#### 子要素
|要素名|説明|
|:---|:---|
|scene要素|1つ以上|
### 2.3. scene 要素
#### 概要
「シーン」を表す要素です。

sequence要素以下に１つ以上配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
#### 子要素
順不同で配置可能。
|要素名|説明|
|:---|:---|
|background 要素|任意|
|caption 要素|任意|
|image 要素|任意|
|select 要素|任意|
|clear 要素|任意|
|fade 要素|任意|
|script 要素|任意|
|html 要素|任意|
### 2.4. background 要素
#### 概要
「背景」を設定するための要素です。

scene要素以下に任意で配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。|
|file 属性|必須　背景ファイルを指定します。|
#### 子要素
不可（空要素タグ）
### 2.5. caption 要素
#### 概要
「キャプション」を設定する要素。

scene要素以下に任意で配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
|name 属性|任意　発言者を指定します。
#### 子要素
テキストのみ
### 2.6. image 要素
#### 概要
「画像」を設定する要素。

scene要素以下に任意で配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
|file |必須　ファイル名を指定します。
|x |任意　x座標を指定します。
|y |任意　y座標を指定します。
|anim |任意　アニメーション効果を指定します。

##### 座標について
画面の中心を(0, 0)として、
左上が(-100, -100)、右下が(100, 100)となります。
これは画面のサイズ、縦横比が変わっても適用されます。

##### 透明度について
0 ～ 100 の値を取り、0が透明となります。

##### anim 属性

```
<image file="images/sample.png" anim="slide({x1}, {y1}, {x2}, {y2}, {opacity1}, {opacity2})" /> 
```
|関数名|説明|
|:---|:---|
|slide|x座標、y座標、透明度を変えながら画像を移動させます。

|パラメータ|説明|
|:---|:---|
|x1|必須　開始時のx座標|
|y1|必須　開始時のy座標|
|x2|必須　終了時のx座標|
|y2|必須　終了時のy座標|
|opacity1|任意　開始時の透明度（0～100）|
|opacity2|任意　終了時の透明度（0～100）|

#### 子要素
不可（空要素タグ）
### 2.7. select 要素
#### 概要
「選択メニュー」を表す要素。

scene要素以下に任意で配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
#### 子要素
|要素名|説明|
|:---|:---|
|option|1つ以上
### 2.8. option 要素
#### 概要
「選択肢」を表す要素。

select要素以下に1つ以上配置できます。
#### 属性
不可
#### 子要素
|要素名|説明|
|:---|:---|
|テキストノード|必須
|script 要素|任意
### 2.9. script 要素
#### 概要
「スクリプト」を設定する要素。
scene要素以下に任意で配置出来ます。

option要素以下に1つ配置できます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
#### 子要素
&lt;![CDATA[～]]>に囲まれたnmlscriptのみ。
### 2.10. fade 要素
#### 概要
「フェードイン」「フェードアウト」を設定する要素。

scene要素以下に任意で配置出来ます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
|from|任意　開始時のalpha値
|to|任意　終了時のalpha値
|time|任意　フェードに要する時間（ミリ秒）
|color|任意　フェードに使用する色
#### 子要素
不可（空要素タグ）
### 2.11. html 要素
#### 概要
外部HTMLを設定するための要素。

scene要素以下に任意で配置出来ます。
#### 属性
|属性名|説明|
|:---|:---|
|id 属性|任意　IDを指定します。
|file|必須　ファイル名を指定します。
|x|任意　x座標を指定します。
|y|任意　y座標を指定します。
|width|任意　幅を指定します。
|height|任意　高さを指定します。
#### 子要素
不可（空要素タグ）

## 3. nmlscript
### 3.1. 基本文法
ECMA Script 6 に準じます。

WEBブラウザのDOMツリーを直接使用できますが、nmlクライアント以外のプロパティ、メソッドを操作することは保証外です。

nmlクライアント用クラスを提供します。

### 3.2. Clientクラス
#### 3.2.1. プロパティ
##### args プロパティ
nml内で使用する変数を格納するプロパティ。

Object型
#### 3.2.2. メソッド
##### getVar メソッド
argsプロパティから値を取得するメソッド
```
Any Client::getVar(string name)
```
argsプロパティに格納されたname要素の値を返します。
##### setVar メソッド
argsプロパティに値を設定するメソッド
```
void Client::setVar(string name, Any value)
```
argsプロパティのname要素にvalue値を設定します。
##### move メソッド
nml内の任意のidに遷移します。
```
void Client::move(string id)
```
##### autosave メソッド
nml.book, nml.scene, Client::args の値をWEBブラウザのlocalstorage.nmlpにJOSN形式で保存します。
```
void Client::autosave()
```

